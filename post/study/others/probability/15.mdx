## 컨볼루션 신경망 (Convolutional Neural Network, CNN)
> 컨볼루션 신경망(CNN)은 이미지 인식 및 분류 작업에 주로 사용되는 심층 학습 모델이다.

CNN은 여러 개의 컨볼루션 계층과 풀링 계층으로 구성되어 있다.
각 계층은 입력 이미지에서 중요한 특징을 추출하고 이를 계층적으로 축적한다.

## 컨볼루션: 이산 경우 (Convolutions: Discrete Case)
$W = X + Y$이며 $X$와 $Y$는 확률 질량 함수(PMF) $p_X(x)$와 $p_Y(y)$를 가지는 독립적인 이산 확률 변수다. 
그러면, 임의의 정수 $w$에 대해,
$p_W(w) = P(X + Y = w) = \sum_x p_X(x) p_Y(w - x)$
결과적으로 얻어지는 PMF $p_W(w)$는 $X$와 $Y$의 PMF의 컨볼루션이라 한다.

### 증명 (컨볼루션: 이산 경우)
임의의 정수 $w$에 대해,
$p_W(w) = P(W = w) = P(X + Y = w) = \sum_x P(X = x, Y = w - x)$
$= \sum_x p_X(x) p_Y(w - x)$

### 예제 (컨볼루션: 이산 경우)
#### 문제
$X$와 $Y$가 독립이고 각각 다음과 같은 PMF를 가질 때,
$
p_X(x) = \begin{cases}
\frac{1}{3} & \text{if } x = 1, 2, 3, \\
0 & \text{otherwise}
\end{cases}
$
$
p_Y(y) = \begin{cases}
	\frac{1}{2} & \text{if } y = 0, \\
	\frac{1}{3} & \text{if } y = 1, \\
	\frac{1}{6} & \text{if } y = 2, \\
	0 & \text{otherwise}
	\end{cases}
$
컨볼루션을 통해 $W = X + Y$의 PMF를 계산하라.

#### 해결
$p_W(1) = \sum p_X(x) p_Y(1 - x) = p_X(1) \cdot p_Y(0) = \frac{1}{3} \cdot \frac{1}{2} = \frac{1}{6}$
$p_W(2) = p_X(1) \cdot p_Y(1) + p_X(2) \cdot p_Y(0) = \frac{1}{3} \cdot \frac{1}{3} + \frac{1}{3} \cdot \frac{1}{2} = \frac{1}{9} + \frac{1}{6} = \frac{5}{18}$
$p_W(3) = p_X(1) \cdot p_Y(2) + p_X(2) \cdot p_Y(1) + p_X(3) \cdot p_Y(0) = \frac{1}{3} \cdot \frac{1}{6} + \frac{1}{3} \cdot \frac{1}{3} + \frac{1}{3} \cdot \frac{1}{2} = \frac{1}{18} + \frac{1}{9} + \frac{1}{6} = \frac{1}{3}$
$p_W(4) = p_X(2) \cdot p_Y(2) + p_X(3) \cdot p_Y(1) = \frac{1}{3} \cdot \frac{1}{6} + \frac{1}{3} \cdot \frac{1}{3} = \frac{1}{18} + \frac{1}{9} = \frac{1}{6}$
$p_W(5) = p_X(3) \cdot p_Y(2) = \frac{1}{3} \cdot \frac{1}{6} = \frac{1}{18}$

## 컨볼루션: 연속 경우 (Convolutions: Continuous Case)
$W = X + Y$이며 $X$와 $Y$는 확률 밀도 함수(PDF) $f_X(x)$와 $f_Y(y)$를 가지는 독립적인 연속 확률 변수다.
그러면, 임의의 실수 $w$에 대해,
$f_W(w) = \int_{-\infty}^{\infty} f_X(x) f_Y(w - x) \, dx = \int_{-\infty}^{\infty} f_X(w - y) f_Y(y) \, dy$
결과적으로 얻어지는 PDF $f_W(w)$는 $X$와 $Y$의 PDF의 컨볼루션이라 한다.

### 증명 (컨볼루션: 연속 경우)
임의의 실수 $w$에 대해,
$
F_W(w) = P(W \leq w) = P(X + Y \leq w)\\
= \int_{x=-\infty}^{\infty} \int_{y=-\infty}^{w-x} f_X(x) f_Y(y) \, dy \, dx\\
= \int_{x=-\infty}^{\infty} f_X(x) \left[ \int_{y=-\infty}^{w-x} f_Y(y) \, dy \right] \, dx\\
= \int_{x=-\infty}^{\infty} f_X(x) F_Y(w - x) \, dx\\
$
<br/>

$
f_W(w) = \frac{dF_W}{dw}(w) = \frac{d}{dw} \left[ \int_{x=-\infty}^{\infty} f_X(x) F_Y(w - x) \, dx \right]\\
= \int_{x=-\infty}^{\infty} f_X(x) \frac{d}{dw} F_Y(w - x) \, dx\\
= \int_{x=-\infty}^{\infty} f_X(x) f_Y(w - x) \, dx\\
$

### 예제 (컨볼루션: 연속 경우)
#### 문제
$X$와 $Y$는 독립적인 확률 변수다. 
$X$는 구간 $[-2, 2]$에서 균등 분포를 따르고, $Y$는 구간 $[-1, 5]$에서 균등 분포를 따른다. 
$Z = X + Y$일 때, $f_Z(3) = \frac{1}{6}$이다. 
참/거짓을 판단하라.

#### 해결
$
f_Z(z) = \int_{-\infty}^{\infty} f_X(x) f_Y(z - x) \, dx = \int_{-\infty}^{\infty} f_X(z - x) f_Y(x) \, dx\\
f_Z(3) = \int_{-\infty}^{\infty} f_X(3 - x) f_Y(x) \, dx = \int_1^5 \left( \frac{1}{4} \right) \left( \frac{1}{6} \right) \, dx = \frac{1}{6}
$
따라서, 참이다.

## 컨볼루션의 그래픽 계산 (Graphic Calculation of Convolutions)
그림을 사용하여 컨볼루션을 계산할 수 있다.
예를 들어, 다음과 같은 컨볼루션 $f_W(w) = \int_{-\infty}^{\infty} f_X(t) f_Y(w - t) \, dt$를 계산하라.
<Img src="/posts/240620-033403.png" width={400}/>
$f_Y(w - t)$: 이 그래프는 $f_Y(t)$의 그래프와 같은 모양이지만 먼저 뒤집힌 다음 $w$만큼 이동한 것이다.
<Img src="/posts/240620-033411.png" width={400}/>
$f_X(t) f_Y(w - t)$: 교차 구간을 찾아 두 그래프의 곱을 계산하라.
<Img src="/posts/240620-033511.png" width={500}/>
$f_W(w) = \int_{-\infty}^{\infty} f_X(t) f_Y(w - t) \, dt$: $f_W(w)$는 교차 구간의 곡선 아래의 전체 면적이다.

### 예제 (컨볼루션의 그래픽 계산)
$X$와 $Y$의 확률 밀도 함수는 다음과 같다. 컨볼루션을 계산하라.
<Img src="/posts/240620-033604.png" width={500}/>

#### 해결
w의 PDF: $f_W(w) = \int_{-\infty}^{\infty} f_X(x) f_Y(w - x) \, dx$

1. $w \leq 0$: $f_W(w) = 0$
	<Img src="/posts/240620-033737.png" width={300}/>
2. $0 < w \leq 1$: $f_W(w) = \int_{0}^{w} f_X(x) f_Y(w - x) \, dx = 2w - \frac{3}{2}w^2 + \frac{1}{6}w^3$
	<Img src="/posts/240620-033818.png" width={300}/>
3. $1 < w \leq 2$: $f_W(w) = \int_{w - 1}^{1} f_X(x) f_Y(w - x) \, dx = \frac{7}{6} - \frac{1}{2}w$
	<Img src="/posts/240620-033834.png" width={300}/>
4. $2 < w \leq 3$: $f_W(w) = \int_{w - 1}^{2} f_X(x) f_Y(w - x) \, dx =  \frac{9}{2} - \frac{9}{2} w + \frac{3}{2} w^2 - \frac{1}{6} w^3$
	<Img src="/posts/240620-034124.png" width={300}/>
5. $w > 3$: $f_W(w) = 0$
	<Img src="/posts/240620-034137.png" width={300}/>
<br/>

*2번 예시*
<Img src="/posts/240620-034339.png" width={200}/>
$f_X(x) = -\frac{1}{2}x + 1$
$f_Y(w-x) = 2x - 2w + 2$
$f_W(w) = \int_{0}^{w} (-\frac{1}{2}x + 1)(2x - 2w + 2) \, dx = 2w - \frac{3}{2}w^2 + \frac{1}{6}w^3$

## 요약 (Summary)
**연속 확률 변수의 컨볼루션**(Convolution of Continuous Random Variables)
- $f_W(w) = \int_{-\infty}^{\infty} f_X(x) f_Y(w - x) \, dx = \int_{-\infty}^{\infty} f_X(w - x) f_Y(x) \, dx$

**이산 확률 변수의 컨볼루션**(Convolution of Discrete Random Variables)
- $p_W(w) = P(X + Y = w) = \sum_x p_X(x) p_Y(w - x)$

## 추가 문제
#### 문제
임의 변수 $X$, $Y$, $Z$는 독립적이며 0과 1 사이에서 균등 분포를 따른다.
$W = X + Y + Z$의 확률 밀도 함수(PDF)를 구하라.

#### 해결
##### V = X + Y
$V = X + Y$의 확률 밀도 함수(PDF)는 다음과 같다.
$f_V(v) = \int_{-\infty}^{\infty} f_X(x) f_Y(v - x) \, dx$
1. $v < 0$: $f_V(v) = 0$
2. $0 \leq v \leq 1$: $f_V(v) = \int_{0}^{v} 1 \, dx = v$
3. $1 \leq v \leq 2$: $f_V(v) = \int_{v - 1}^{1} 1 \, dx = 2 - v$
4. $v > 2$: $f_V(v) = 0$

$f_V(v) = \begin{cases}
v & \text{if } 0 \leq v \leq 1, \\
2 - v & \text{if } 1 \leq v \leq 2, \\
0 & \text{otherwise}
\end{cases}$
<br/>
<br/>
<br/>

##### W = V + Z
$W = V + Z$의 확률 밀도 함수(PDF)는 다음과 같다.
$f_W(w) = \int_{-\infty}^{\infty} f_V(v) f_Z(w - v) \, dv$
1. $w < 0$: $f_W(w) = 0$
2. $0 \leq w \leq 1$: $f_W(w) = \int_{0}^{w} v \, dv = \frac{1}{2}w^2$
3. $1 \leq w \leq 2$: $f_W(w) = \int_{w - 1}^{1} v \, dv + \int_{1}^{w} (2 - v) \, dv = 1 - \frac{(w-1)^2}{2} - \frac{(2-w)^2}{2}$
4. $2 \leq w \leq 3$: $f_W(w) = \int_{w - 1}^{2} (2 - v) \, dv = \frac{(3-2)^2}{2}$
5. $w > 3$: $f_W(w) = 0$

$f_W(w) = \begin{cases}
\frac{1}{2}w^2 & \text{if } 0 \leq w \leq 1, \\
1 - \frac{(w-1)^2}{2} - \frac{(2-w)^2}{2} & \text{if } 1 \leq w \leq 2, \\
\frac{(3-w)^2}{2} & \text{if } 2 \leq w \leq 3, \\
0 & \text{otherwise}
\end{cases}$