## 곱셈 표기법 vs 덧셈 표기법 (Multiplication vs Additive)
| Multiplicative Notation | Operation | Additive Notation |
| --- | --- | --- |
| $g$ | Generator | $P$ |
| $g \cdot h$ | Multiplication/Addition | $P + Q$ |
| $g^x = g \cdot g \cdots g \ \text{(x times)}$ | Exponentiation/Scalar Multiplication | $xP = P + P + \cdots + P \ \text{(x times)}$ |

곱셈 표기법은 주로 모듈러 연산과 같은 분야, 덧셈 표기법은 타원곡선 암호학과 같은 분야에서 사용된다.
예를 들어, 디피-헬만 키 교환에서는 곱셈 표기법을 사용하여 $g^a \cdot g^b = g^{a+b}$를 계산한다.
반면에 타원곡선 암호학에서는 덧셈 표기법을 사용하여 $aP + bP = (a+b)P$를 계산한다.

## 덧셈 표기법을 이용한 DSA (DSA with Additive Notation)
### 키 생성 (RSA Key Generation)
1. 순서 $q$를 가지는 (*덧셈적*) 순환 그룹 $G$를 선택한다.
2. $G$에서 생성자 $P$를 선택한다.
3. $Z_q^*$에서 임의의 정수 $x$를 선택한 후 $Q = xP$를 계산한다.
4. 공개 키 $pk = (q, P, Q)$, 개인 키 $sk = x$를 반환한다.

### 서명 (DSA Signature)
개인 키 $sk = x$와 메시지 $M$이 주어졌을 때
1. $Z_q^*$에서 임의의 $k$를 선택한다.
2. $r = kP \pmod{q}$와 $s = k^{-1}(H(M) + xr) \pmod{q}$를 계산한다.
3. 서명 $\sigma = (M, r, s)$를 반환한다.

### 검증 (DSA Signature Verification)
공개 키 $pk = (q, P, Q)$와 메시지 $M$에 대한 서명 $\sigma = (M, r, s)$가 주어졌을 때
1. $w = s^{-1} \pmod{q}$를 계산한다.
2. $u_1 = H(M)w \pmod{q}$와 $u_2 = rw \pmod{q}$를 계산한다.
3. $v = u_1P + u_2Q \pmod{q}$를 계산한다.
4. $v \stackrel{?}{=} r \pmod{q}$를 확인한다. 이 조건이 성립하면 1을 반환하고, 그렇지 않으면 0을 반환한다.

### 정확성 (DSA Signature correctness)
$u_1P + u_2Q = (u_1 + u_2x)P = (s^{-1}H(M) + s^{-1}xr)P $
$= k(H(M) + xr)^{-1}(H(M) + xr)P = kP$

#### 덧셈 표기법을 이용한 DSA에서 고려할 점
1. (안전한)덧셈 그룹을 어떻게 생성할 것인가
2. 모듈러 연산을 어떻게 처리할 것인가

## 타원 곡선 (Elliptic Curve)
<Bbox>$E: Y^2 = X^3 + AX + B$</Bbox>
> Weierstrass 형태의 방정식 해 집합

여기서 상수 $A$와 $B$는 타원곡선의 계수로, $4A^3 + 27B^2 \neq 0$이어야 한다.
또한 타원곡선은 추가적인 점 $\mathcal{O}$을 가진다.

### 예시 (타원 곡선)
1. $E: Y^2 = X^3 -3X+3$
	<Img src="/posts/240613-111004.png" width="100"/>
2. $E: Y^2 = X^3 -6X+5$
	<Img src="/posts/240613-111652.png" width="100"/>

## 수학적 구조: 유한필드 (Mathematical Structure: Finite Field)
> 필드 $\mathbb{F}_p$는 덧셈, 곱셈 뺄셈, 그리고 0이 아닌 요소들에 대한 나눗셈이 가능한 수학적 구조이다.
또한 결합 법칙, 교환 법칙, 분배 법칙이 성립한다.

- 결합 법칙: $(a+b)+c = a+(b+c)$, $(ab)c = a(bc)$
- 교환 법칙: $a+b = b+a$, $ab = ba$
- 분배 법칙: $a(b+c) = ab+ac$

실수 집합, 복소수 집합은 필드이지만 정수 집합은 필드가 아니다.
$\mathbb{Z}_p = \{0, 1, 2, \cdots, p-1\}$는 $p$가 *소수*일 때 유한필드이다.
다항식 유한 필드 $GF(p^n)$은 $p^n$ 요소를 가지는 필드 (계수가 $p$인 차수 $n$의 다항식의 집합)이다.
($\mathbb{Z}_p[X] \mod{P(X)}$에서 $P(X)$는 차수 $n$의 기약 다항식이다.)

## 유한 필드 위의 타원곡선 (Elliptic Curve over Finite Field)
타원곡선은 유한필드 $\mathbb{F}_p$ 위에서 정의될 수 있다.

### 예시 (유한 필드 위의 타원곡선)
$E : Y^2 = X^3 + 3X + 8 \;\text{over}\; \mathbb{F}_{13}$
- $\mathbb{F}_{13} = \{0, 1, 2, \cdots, 12\}$
- $X = 0; Y^2 = 8 \rightarrow \mathbb{F}_{13}$에 $Y$가 존재하지 않음
- $X = 1; Y^2 = 12 \rightarrow 5^2 \equiv 12 \pmod{13}, 8^2 \equiv 12 \pmod{13} \;\text{in}\; \mathbb{F}_{13}$

...
$\therefore E(\mathbb{F}_{13}) = \{\mathcal{O}, (1, 5), (1, 8), (2, 3), (2, 10), (9, 6), (9, 7), (12, 2), (12, 11)\}$

## 타원 곡선 위의 덧셈 정리 (Addition on Elliptic Curve Points)
타원곡선 위의 두 점 $P = (x_1, y_1)$, $Q = (x_2, y_2)$에 대해 $P + Q = R = (x_3, y_3)$를 계산하는 방법
<Ybox>

$x_3 = s^2 - x_1 - x_2$
$y_3 = s(x_1 - x_3) - y_1$
</Ybox>

여기서 기울기 $s = \frac{y_2 - y_1}{x_2 - x_1}$이다.

- $Y^2 = X^3 + AX + B$와 $Y = sX + t$의 교점 찾기
	1. $(sX + t)^2 = X^3 + AX + B$
	2. $s^2X^2 + 2st + t^2 = X^3 + AX + B$
	3. $X^3 - s^2X^2 + (A-2st)X + (B-t^2) = 0$
- 세 근 $x_1, x_2, x_3$의 합은 $s^2$이다.
	$x_1 + x_2 + x_3 = s^2 \Rightarrow \underline{x_3 = s^2 - x_1 - x_2}$
- $P = (x_1, y_1)$와 $-R = (x_3, -y_3)$은 $Y = sX + t$위에 있다.
	$y_1 = sx_1 + t \Rightarrow t = y_1 - sx_1$
	$-y_3 = sx_3 + t = sx_3 + (y_1 - sx_1) s(x_3 - x_1) + y_1$
	$\Rightarrow \underline{y_3 = s(x_1 - x_3) - y_1}$

### 예시 (타원곡선 위의 덧셈)
$E : Y^2 = X^3 + 3X + 8 \;\text{over}\; \mathbb{F}_{13}$
$E(\mathbb{F}_{13})$에서 두 점 $P = (9, 7)$과 $Q = (1, 8)$가 주어졌을 때,
$s = \frac{8 - 7}{1 - 9} = \frac{1}{-8} = \frac {1}{5} = 8 \pmod{13} (\because \; 5 \cdot  8 = 40 = 1 \pmod{13})$
$x_3 =  s^2 - x_1 - x_2 = 8^2 - 9 - 1 = 64 - 10 = 54 = 2 \pmod{13}$
$y_3 = s(x_1 - x_3) - y_1 = 8(9 - 2) - 7 = 8 \cdot 7 - 7 = 49 = 10 \pmod{13}$
$\therefore P + Q = (9, 7) + (1, 8) = (2, 10) = R$
<br/>

타원 곡선 덧셈은 *ECC*(Elliptic Curve Cryptography)에서 사용되는 기본 연산이다.

## 타원 곡선 위의 두 배 연산 (Doubling on Elliptic Curve Points)
타원곡선 위의 점 $P = (x_1, y_1)$에 대해 $2P = R = (x_3, y_3)$를 계산하는 방법

<Ybox>

$x_3 = s^2 - 2x_1$
$y_3 = s(x_1 - x_3) - y_1$
</Ybox>

여기서 기울기 $s = \frac{3x_1^2 + A}{2y_1}$이다.

- $Y^2 = X^3 + AX + B$와 $Y = sX + t$의 교점 찾기(*덧셈 정리*와 동일)
- 점 $P$에서 접선의 기울기 계산하려면 $Y^2 = X^3 + AX + B$의 *도함수*를 이용한다.
	$2Y \frac{dY}{dX} = 3X^2 + A \Rightarrow \frac{dY}{dX} = \frac{3X^2 + A}{2Y}$
	$\therefore \underline{s = \frac{3x_1^2 + A}{2y_1}}$
- $P = (x_1, y_1)$와 $-R = (x_3, -y_3)$은 $Y = sX + t$위에 있다.(*덧셈 정리*와 동일)

### 예시 (타원곡선 위의 두 배 연산)
$E : Y^2 = X^3 + 3X + 8 \;\text{over}\; \mathbb{F}_{13}$
$E(\mathbb{F}_{13})$에서 점 $P = (9, 7)$가 주어졌을 때,
$s = \frac{3 \cdot 9^2 + 3}{2 \cdot 7} = \frac{243 + 3}{14} = \frac{246}{14} = \frac{-1}{1} = -1$
$(\because 246 = -1 \pmod{13}, 14 = 1 \pmod{13})$
$x_3 = s^2 - 2x_1 = (-1)^2 - 2 \cdot 9 = 1 - 18 = -17 = -4 = 9 \pmod{13}$
$y_3 = s(x_1 - x_3) - y_1 = -1(9 - 9) - 7 = 0 - 7 = -7 = 6 \pmod{13}$
$\therefore 2P = (9, 7) + (9, 7) = (9, 6) = R$

## 타원 곡선 위의 스칼라 곱셈 (Scalar Multiplication on Elliptic Curve Points)
모듈러 거듭제곱을 위한 알고리즘을 고려해야 함
- 곱셈 $\rightarrow$ 덧셈 (ex: $2P = P + P$)
- 거듭제곱 $\rightarrow$ 두 배 연산 (ex: $2^kP = 2^{k-1}P + 2^{k-1}P$)
### 예시 (모듈러 거듭제곱을 위한 알고리즘)
Right to Left Algorithm
점 $P$와 양의 정수 $x = (x_{l-1}, x_{l-2}, \cdots, x_0)_2$가 주어졌을 때,
```python
R = O, T = P 
for i from 0 to l-1 do
	if x_i = 1 then
		R = R + T
	T = 2T
end for
return R
```

## 타원 곡선의 장점 (Advantages of Elliptic Curve)
- 짧은 파라미터 크기
- $Z_p^*$의 부분군 $\mathbb{G}$에서 정의된 DLP(이산 로그 문제) 해결
	- $p$가 크지 않다면 가장 좋은 공격은 숫자 체 방법
	- $q$가 크지 않다면 가장 좋은 공격은 Pollard Rho 방법
- 타원 곡선 위에서 정의된 DLP를 해결하기 위한 최선의 알고리즘은 Pollard Rho 방법

## 타원 곡선 DSA: ECDSA (Elliptic Curve Digital Signature Algorithm)
### 키 생성 (ECDSA Key Generation)
1. 타원 곡선 $E$를 사용하여 다음을 선택한다.
	- 모듈러스 $p$
	- 타원 곡선 계수 $a$와 $b$
	- 소수 차수 $q$의 순환 그룹을 생성하는 점 $P$ (생성자)
2. $Z_q^*$에서 임의의 정수 $x$를 선택한 후 $Q = xP$를 계산한다.
3. 공개 키 $pk = (p, a, b, q, P, Q)$, 개인 키 $sk = x$를 반환한다.

### 서명 (ECDSA Signature)
개인 키 $sk = x$와 메시지 $M$이 주어졌을 때
1. $Z_q^*$에서 임의의 $k$를 선택한다.
2. $R = kP$를 계산한 후 $r = x_R$(점 $R$의 $x$ 좌표)를 둔다.
3. $s = k^{-1}(H(M) + xr) \pmod{q}$를 계산한다.
4. 서명 $\sigma = (M, (r, s))$를 반환한다.

### 검증 (ECDSA Signature Verification)
공개 키 $pk = (p, a, b, q, P, Q)$와 메시지 $M$에 대한 서명 $\sigma = (M, (r, s))$가 주어졌을 때
1. $w = s^{-1} \pmod{q}$를 계산한다.
2. $u_1 = H(M)w \pmod{q}$와 $u_2 = rw \pmod{q}$를 계산한다.
3. $R = u_1P + u_2Q$를 계산한다.
4. $r \stackrel{?}{=} x_R \pmod{q}$를 확인한다. 이 조건이 성립하면 1을 반환하고, 그렇지 않으면 0을 반환한다.

### 정확성 (ECDSA Signature correctness)
$R = u_1P + u_2Q = (u_1 + u_2x)P = (w(H(M) + xr))P $
$= k(H(M)+xr)^{-1}(H(M)+xr)P = kP$
$\Rightarrow r = $ $kP$의 $x$ 좌표 = $R$의 $x$ 좌표$\pmod{q}$

## 추가> 타원 곡선 ElGamal (Elliptic Curve ElGamal)
### 키 생성 (EC ElGamal Key Generation)
1. 타원 곡선 $E$를 사용하여 다음을 선택한다.
	- 모듈러스 $p$
	- 타원 곡선 계수 $a$와 $b$
	- 소수 차수 $q$의 순환 그룹을 생성하는 점 $G$ (생성자)
2. $Z_q^*$에서 임의의 정수 $x$를 선택한 후 $X = xG$를 계산한다.
3. 공개 키 $pk = (p, a, b, q, G, X)$, 개인 키 $sk = x$를 반환한다.

### 암호화 (EC ElGamal Encryption)
공개 키 $pk = (p, a, b, q, G, X)$와 평문 $M$이 주어졌을 때
1. $Z_q^*$에서 임의의 원소 $r$를 선택한다.
2. $C_1 = rG$, $C_2 = M + rX$를 계산한다.
3. 암호문 $C = (C_1, C_2)$를 반환한다.

### 복호화 (EC ElGamal Decryption)
개인 키 $sk = x$와 암호문 $C = (C_1, C_2)$가 주어졌을 때
1. $M = C_2 - xC_1$를 계산한다.($= M + rX - x(rG) = M + rX - rX$)
2. 평문 $M$을 반환한다.