# 개요
## 배경: DC 전력선 통신(Line-Fi)
> 전력선을 통해 데이터를 전송하는 기술로 DC 전력선을 사용한다.

- 다운 링크: 전력선의 전압 극성을 변경하여 데이터 패킷 전송 (VSC)
- 업 링크: 전력선의 전류 극성을 변경하여 데이터 패킷 전송 (CSC)

## 고려 사항
- 마스터는 모든 슬레이브에게 신호를 보낼 수 있다.
- 슬레이브는 마스터에게만 신호를 보낼 수 있다.
- 두 개 이상의 슬레이브가 동시에 데이터를 보내면
	- 신호가 충돌하거나 손상된다.
	- 마스터는 해독 불가능하다.
	- 두 개의 슬레이브는 데이터를 동시에 전송해서는 안된다.
- 마스터와 슬레이브는 동시에 전송할 수 있다
	- 두 개의 양방향 통신이 작동한다고 가정

## 통신 시나리오

<Bbox> 마스터 -> 슬레이브 </Bbox>
- 마스터는 모든 슬레이브에게 무언가를 보낼 수 있다.
- 마스터는 특정 슬레이브에게 무언가를 보낼 수 있다.
- (선택 사항) 마스터는 몇몇 슬레이브에게 무언가를 보낼 수 있다.

<Bbox> 슬레이브 -> 마스터 </Bbox>
- 슬레이브는 마스터에게만 무언가를 보낼 수 있다.
- (선택 사항) 슬레이브는 다른 슬레이브에게 무언가를 보낼 수 있다.

<Bbox> 트래픽 패턴 </Bbox>
- 주기적일 수 있다 (예: 매 100ms 마다 무언가를 전송)
- 비주기적일 수 있다 (예: 이벤트 발생 시 전송)

## 시스템 요구 사항
1. 마스터 -> 슬레이브
	- 마스터는 모든 슬레이브에게 패킷을 보낼 수 있다.
2. 슬레이브 -> 마스터
	- 슬레이브는 마스터에게만 패킷을 보낼 수 있다.
3. 슬레이브 간 충돌
	- 두 개 이상의 슬레이브가 동시에 패킷을 전송하면 충돌/손상이 발생하고 마스터는 이를 해독할 수 없다.
	- 따라서 두 슬레이브는 동시간에 패킷을 전송해서는 안된다.
4. 동시 전송
	- 마스터와 슬레이브는 동시에 전송할 수 있다.
	- 동시에 양방향 통신이 가능하다고 가정
5. 주소 지정
	- 각 장치는 고유한 2바이트 주소를 가지고 있다 (N \<\< 100~200)
6. 캐리어 감지 불가
	- 캐리어 감지 기능이 없으므로 CCA/CSMA를 사용할 수 없다.
7. 전송 속도
	- 다운링크 전송 속도: 1kbps
	- 업링크 전송 속도: 2kbps

## 디자인 질문
> 시스템의 기본 요구 사항을 고려할 때, 마스터와 슬레이브를 위한 양방향 통신 프로토콜과 알고리즘을 어떻게 설계할 것인가?

- 두 명 이상의 슬레이브가 동시에 전송해서는 안 되는 경우, 슬레이브는 충돌을 피하기 위해 언제 전송해야 하는가? 얼마나 자주(빠르게) 전송할 수 있는가?
- 마스터는 언제 전송해야 하는가?
- 시스템은 비트 오류를 어떻게 처리해야 하는가?
- 시스템은 패킷 손실을 어떻게 처리해야 하는가?
- 패킷 형식은 어떻게 되어야 하는가? 헤더에 어떤 정보가 포함되어야 하는가?
- 설계는 OSI 7계층의 2계층과 3계층 주위에 있을 것이다.

## 추가 요구사항
>이전에는 '패킷'이라고 했지만, 마스터와 슬레이브는 전압/전류 '신호'를 전송하며 이 신호는 '비트'로 디코딩될 수 있다.

디바이스가 신호로부터 패킷을 신뢰성 있게 검출할 수 있도록 패킷 형식은 어떻게 되어야 하는가? (참고로 신호는 비트처럼 보일 수 있으며, '신호 없음'도 비트처럼 보일 수 있다)
예시: 프리엠블? SFD? CRC/체크섬? EFD? HDLC?
설계가 효율적인가? 활용도가 좋은가? 생각할 수 있는 모든 것...

- 예시: 시간을 최대한 낭비하지 않으려면 어떻게 해야 하는가?
- 예시: 슬레이브가 무언가를 전송하고 싶을 때 얼마나 기다려야 하는가?
- 예시: 슬레이브가 다른 슬레이브에게 패킷을 어떻게 보낼 수 있는가?
- 예시: 마스터가 한 번의 전송으로 여러 슬레이브에게 패킷을 어떻게 보낼 수 있는가?