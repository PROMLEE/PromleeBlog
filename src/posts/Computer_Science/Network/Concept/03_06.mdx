
# 3.6 혼잡 제어 원칙 (Principles of Congestion Control)
## 혼잡 제어의 원칙 (Principles of Congestion Control)
- 혼잡:
	-  비공식적으로: "네트워크가 처리할 수 있는 것보다 너무 많은 소스에서 너무 빠르게 데이터를 보냄"
- 흐름 제어와는 다름!
- 현상:
	- 분실된 패킷(라우터에서의 버퍼 오버플로우)
	- 긴 지연(라우터 버퍼에서의 큐잉)
- 10대 문제 중 하나!

- 혼잡을 감지하는 방법은?
- 혼잡이 감지되었을 때의 대응 방법은?

### 추가 설명

혼잡 제어는 네트워크에서 중요한 과제 중 하나이며, 특히 대규모 데이터를 전송하는 환경에서 중요하다. 이는 다음과 같은 두 가지 주요 문제로 나타난다:

1. **분실된 패킷**: 많은 데이터 패킷이 동시에 네트워크로 전송될 때, 라우터의 버퍼 용량이 초과되어 일부 패킷이 분실될 수 있다. 이는 데이터 전송의 신뢰성을 저하시키며, 통신 효율성을 크게 떨어뜨린다.
2. **긴 지연 시간**: 네트워크의 트래픽이 라우터의 처리 용량을 초과할 경우, 패킷은 큐에서 대기해야 하며 이로 인해 전송 지연이 발생한다.

혼잡을 감지하는 방법으로는 네트워크의 패킷 손실율과 지연 시간을 측정하는 것이 포함된다. 혼잡이 감지되면, 데이터 전송 속도를 조정하거나, 데이터의 우선 순위를 재정렬하는 등의 조치를 취할 수 있다. 이러한 조치들은 네트워크의 효율을 개선하고, 데이터 전송의 신뢰성을 보장하기 위해 필수적이다.

## 혼잡의 원인 및 비용: 시나리오 1 (Causes and Costs of Congestion: Scenario 1)
  - 두 발신자, 두 수신자
  - 하나의 라우터, 무한 버퍼 -> no packet loss
  - 출력 링크 용량: R
  - 재전송 없음
  - 무제한 공유 출력 링크 버퍼

### 추가 설명

이 시나리오는 네트워크에서의 혼잡 현상과 그 비용을 설명하고 있다. 주요 요소는 다음과 같다:

1. **데이터 전송**: 두 호스트(A와 B)가 데이터를 라우터를 통해 다른 두 호스트(C와 D)에게 전송한다. 각 호스트는 원본 데이터($\lambda_{in}$)를 발신하며, 이 데이터는 라우터를 통해 처리된다.

2. **라우터 용량과 버퍼**: 라우터는 무한 버퍼를 가지고 있으며, 출력 링크의 용량은 R로 제한되어 있다. 이는 네트워크의 출력 링크에서 데이터가 처리될 수 있는 최대 속도를 의미한다.

3. **처리량과 지연**: 그래프는 입력 데이터의 도착률($\lambda_{in}$)에 따른 출력 데이터의 처리량($\lambda_{out}$)과 지연을 나타낸다. 도착률이 R/2에 도달할 때까지는 처리량이 선형적으로 증가하다가 그 이후로는 포화 상태에 도달하여 처리량이 일정하게 유지된다. 반면, 지연은 도착률이 R/2를 초과함에 따라 급격히 증가한다.

이 시나리오는 네트워크에서 데이터 도착률이 라우터의 처리 용량에 근접하거나 초과할 때 발생하는 혼잡과 그로 인한 지연을 보여준다. 혼잡이 발생하면, 라우터 버퍼에 데이터가 쌓이기 시작하고, 이로 인해 패킷 지연이 증가하며 네트워크 성능이 저하될 수 있다. 이는 네트워크 설계와 관리에서 중요한 고려사항이다.


## 혼잡의 원인 및 비용: 시나리오 2 (Causes and Costs of Congestion: Scenario 2)
  - 하나의 라우터, 유한 버퍼
  - 발신자는 시간 초과된 패킷을 재전송한다.
    - 응용 계층 입력 = 응용 계층 출력: $\lambda_{in} = \lambda_{out}$
    - 전송 계층 출력은 재전송을 포함한다: $\lambda'_{in} \geq \lambda_{in}$

### 추가 설명

이 시나리오는 유한 버퍼를 가진 네트워크 라우터와 관련된 혼잡의 복잡성을 설명한다. 여기에는 다음과 같은 요소가 포함된다:

1. **재전송 메커니즘**: 패킷 전송 실패 또는 시간 초과로 인한 패킷 손실이 발생하면, 발신자는 해당 패킷을 재전송한다. 이는 전송 계층에서 처리되며, 이로 인해 네트워크에 전송되는 총 데이터량이 증가한다.

2. **유한 버퍼**: 라우터의 버퍼가 유한하다는 것은 네트워크 트래픽이 라우터의 버퍼 용량을 초과할 경우 패킷이 버려지게 됨을 의미한다. 이러한 상황은 네트워크 성능을 저하시키고, 더 많은 재전송을 필요로 하게 된다.

3. **입력과 출력의 관계**: 이 시나리오에서는 응용 계층의 입력과 출력이 동일하다고 가정한다. 즉, 응용 계층에서 네트워크로 전송되는 데이터의 양은 라우터를 통해 전송되어야 하는 데이터의 양과 같다. 그러나 전송 계층의 출력은 재전송된 데이터를 포함하기 때문에 실제 라우터를 통과하는 데이터량은 더 많아진다.

이 시나리오는 유한한 자원을 가진 네트워크에서 재전송으로 인해 발생할 수 있는 혼잡 문제를 잘 보여준다. 재전송은 필요한 경우에만 수행되어야 하며, 네트워크 설계와 운영에서는 이를 최소화하기 위한 전략이 중요하다. 혼잡 제어 메커니즘은 네트워크의 버퍼 용량과 트래픽 패턴을 고려하여 효율적으로 구현되어야 한다.


## 혼잡의 원인 및 비용: 시나리오 2-1 (Causes and Costs of Congestion: Scenario 2-1)
- 이상화-1: 완벽한 지식
	- 발신자는 라우터 버퍼에 공간이 있을 때만 데이터를 전송한다.

### 추가 설명

이 시나리오는 이상적인 네트워크 상황에서의 혼잡 제어 방법을 설명하며, 발신자가 라우터의 버퍼 상태에 대한 완벽한 지식을 가지고 있을 때의 데이터 전송 방식을 보여준다. 주요 특징은 다음과 같다:

1. **완벽한 버퍼 관리**: 발신자는 라우터의 버퍼에 충분한 공간이 있을 때만 데이터를 전송한다. 이는 네트워크의 혼잡을 방지하고, 데이터 패킷의 손실을 최소화하는 데 도움이 된다.

2. **데이터 전송 및 재전송**: 원본 데이터($\lambda_{in}$)와 재전송되는 데이터($\lambda'_{in}$)가 모두 포함되어 있음에도 불구하고, 버퍼의 이용 가능성에 따라 전송이 이루어진다는 점에서, 라우터의 효율적인 운용이 가능하다.

3. **처리량 그래프**: 제시된 그래프에서는 입력 데이터의 도착률($\lambda_{in}$)이 증가함에 따라 출력 데이터의 처리량($\lambda_{out}$)이 선형적으로 증가하다가 R/2에서 포화 상태에 도달하는 것을 보여준다. 이는 라우터가 처리할 수 있는 최대 용량을 나타낸다.

이 시나리오는 이상적인 혼잡 제어 상황을 가정하며, 실제 네트워크 환경에서 이러한 조건을 완벽하게 구현하기는 어려울 수 있다. 그러나, 이러한 접근 방식은 네트워크 설계와 관리에서 혼잡을 줄이고 전체적인 성능을 개선하기 위한 중요한 기준을 제공한다. 이는 네트워크 리소스의 효율적 사용과 지연 시간의 최소화를 위해 중요하다.


## 혼잡의 원인 및 비용: 시나리오 2-2
- 이상화-2: 알려진 손실 패킷
	- 패킷이 버퍼가 가득 차서 라우터에서 손실될 수 있음
	- 발신자는 패킷이 분실되었다는 것을 알 때만 재전송함

### 추가 설명

이 시나리오는 네트워크 혼잡 상황에서 패킷 손실을 관리하는 방법을 설명하며, 발신자가 패킷 손실에 대한 정보를 알고 있을 때의 대응 전략을 보여준다. 주요 요소는 다음과 같다:

1. **버퍼 손실**: 라우터의 버퍼가 가득 차 있을 때 추가 패킷이 도착하면, 새로운 패킷은 버려지거나 드랍된다. 이는 네트워크의 처리 능력이 한계에 도달했음을 의미한다.

2. **재전송 전략**: 발신자는 패킷이 손실되었다는 명확한 피드백(예: 확인 응답 미수신, 명시적 손실 통지 등)을 받았을 때만 해당 패킷을 재전송한다. 이는 불필요한 재전송을 방지하고, 네트워크 자원의 효율적 사용을 도모한다.

3. **네트워크 효율성**: 알려진 패킷 손실 정보를 통해 발신자는 네트워크 상태를 더 잘 이해하고, 데이터 전송을 보다 효율적으로 조절할 수 있다. 이는 전체적인 네트워크 성능을 개선하고, 혼잡으로 인한 비용을 줄이는 데 기여한다.

이 시나리오는 혼잡 제어 메커니즘에서 발신자와 라우터 간의 상호작용을 강조하며, 정보에 기반한 의사결정이 네트워크의 안정성과 성능에 어떤 영향을 미칠 수 있는지를 보여준다. 이러한 접근 방식은 특히 대규모 데이터 전송이 이루어지는 환경에서 중요하며, 패킷 손실과 지연을 최소화하기 위해 중요한 전략이다.

## 혼잡의 원인 및 비용: 시나리오 2-3
- 현실적: 중복 발생 가능
	- 패킷은 버퍼가 가득 차서 라우터에서 분실될 수 있음 → 타임아웃이 필요함.
	- 발신자가 조기에 타임아웃되어 두 개의 복사본을 보내고, 두 복사본 모두 전달됨.

### 추가 설명

이 시나리오는 네트워크 혼잡 시 발생할 수 있는 패킷 중복 전송 문제와 그로 인한 비용을 설명한다. 이는 다음과 같은 여러 요소를 포함한다:

1. **패킷 손실과 재전송**: 라우터의 버퍼가 가득 찼을 때 패킷이 손실될 수 있고, 이로 인해 발신자는 타임아웃 후에 해당 패킷을 재전송한다. 하지만, 원본 패킷이 지연되어 나중에 도착하는 경우가 발생할 수 있으며, 결과적으로 중복 패킷이 네트워크를 통해 전송될 수 있다.

2. **중복의 비용**: 재전송된 패킷들이 네트워크를 통과하는 동안, 이들은 불필요한 네트워크 자원을 사용하고, 전체적인 네트워크 성능을 저하시킬 수 있다. 특히, 두 복사본 모두가 전달되면 네트워크의 처리량(throughput)에 영향을 미치지만 실제로 유용한 데이터 전송량(goodput)은 감소한다.

3. **혼잡의 비용**: 이러한 중복 전송은 네트워크의 혼잡을 증가시키며, 이로 인해 더 많은 재전송이 필요하게 될 수 있다. 이는 전체적으로 네트워크의 효율성을 떨어뜨리는 결과를 초래한다.

시나리오 2-3은 네트워크 설계와 관리에서 중복 패킷을 최소화하기 위한 전략이 얼마나 중요한지를 보여준다. 이를 통해 네트워크 리소스를 보다 효율적으로 관리하고, 전체적인 네트워크 성능을 개선할 수 있는 방법을 모색할 수 있다.

## 혼잡의 원인 및 비용: 시나리오 3
- 네 발신자, 멀티홉 경로
- 타임아웃/재전송
- 질문: $\lambda_{in}$ 및 $\lambda'_{in}$이 증가함에 따라 어떤 일이 발생하는가?
- 답변: 빨간색 $\lambda'_{in}$이 증가함에 따라 상단 큐에 도착하는 모든 파란색 패킷이 드롭되고, 파란색 처리량은 거의 0에 가까워진다.

### 추가 설명

이 시나리오는 네트워크의 여러 발신자와 복잡한 전송 경로를 통한 데이터의 이동과 혼잡의 영향을 보여준다. 주요 요소는 다음과 같다:

1. **데이터 흐름과 혼잡**: 여러 발신자가 데이터를 보내면서 네트워크의 특정 부분, 특히 공유 출력 링크의 버퍼가 포화 상태에 이르게 된다. 이 경우 $\lambda'_{in}$ (원본 데이터와 재전송 데이터를 합친 양)이 증가함에 따라, 처리량이 급격히 감소하고, 패킷 손실이 발생하기 시작한다.

2. **패킷 손실과 처리량 감소**: 시나리오에서 보여주는 그래프는 입력률이 증가함에 따라 초기에는 처리량이 증가하지만, 특정 지점(C/2)을 초과하면 급격히 감소함을 나타낸다. 이는 버퍼 오버플로우로 인해 발생하는 패킷 드롭 때문이다.

3. **비용**: 패킷이 드롭될 때, 그 패킷을 전송하기 위해 사용된 모든 상류 네트워크 자원(대역폭, 라우터 처리 시간 등)은 낭비된다. 이는 네트워크의 전반적인 효율성을 저하시키며, 필요 이상의 재전송으로 인해 네트워크 혼잡을 가중시킬 수 있다.

이 시나리오는 네트워크 설계자들이 혼잡 제어 메커니즘을 효과적으로 구현하여, 높은 트래픽 상황에서도 네트워크 성능을 최적화할 수 있도록 중요한 통찰을 제공한다. 패킷 드롭과 재전송 최소화는 네트워크 성능을 유지하고 비용을 절감하는 데 필수적인 요소이다.
